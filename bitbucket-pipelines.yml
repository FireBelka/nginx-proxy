pipelines:
  default:
      - step:
          name: Docker-compose build and push to ACR
          image: atlassian/default-image:2
          caches:
            - docker
          script:
            - docker login azure -u $AZURE_APP_ID -p $AZURE_PASSWORD -t $AZURE_TENANT_ID
      #      - docker login -u $DOCKER_USER -p $DOCKER_PASSWORD $DOCKER_LOGIN_SERVER
      #      - docker-compose -f docker-compose.yml build
      #      - docker-compose -f docker-compose.yml push
          services:
            - docker
      - step:
          name: Login to Azure
          image: mcr.microsoft.com/azure-cli
          script:
            - az login --service-principal -u $AZURE_APP_ID -p $AZURE_PASSWORD --tenant $AZURE_TENANT_ID
      #      - az webapp restart --name nginx-proxy-app --resource-group nginx-proxy --slot staging
